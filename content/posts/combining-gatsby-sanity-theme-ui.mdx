---
title: Combining Gatsby, SANITY.io, and Theme-UI
author: Eric Howey
authorLink: https://twitter.com/erchwy
tags: [Gatsby, Catalyst, Themes]
date: 2020-02-08
featuredImage: ../post-assets/featured-gatsby-sanity-theme-ui.jpg
draft: true
---

This trio of web development technologies is quickly becoming my goto stack of development tools. Gatsby on the frontend. SANITY on the backend. Theme-UI as the design system interface. Combining these three tools has been smooth, with one exception - linking Theme-UI design tokens to SANITY block content.

## Understanding data and serializers in SANITY

SANITY stores your content as raw structured data, what they call [block content or portable text](https://www.sanity.io/docs/presenting-block-text), agnostic of how it is going to be ultimately presented. It is not stored as HTML, Javascript, or Markdown like in other CMSs. This raw data has to be translated into a presentational format that can be displayed to the end user.

There are many upsides to this approach to content however the downside is that you need to tell SANITY how to translate your content using what is called a ‘serializer’ and the official [block-content-to-react](https://github.com/sanity-io/block-content-to-react) component. A serializer is a computer science term to describe programatically changing data from one format to another.

## Block content to React

The first step to translating the data

## Example serializer

```jsx
/** @jsx jsx */
import { jsx, Styled } from "theme-ui"
import Figure from "./figure"
import FigureWide from "./figure-wide"

const serializers = {
  types: {
    figure: Figure,
    figureWide: FigureWide,
    block(props) {
      switch (props.node.style) {
        case "h1":
          return <Styled.h1>{props.children}</Styled.h1>
        case "h2":
          return <Styled.h2>{props.children}</Styled.h2>
        case "h3":
          return <Styled.h3>{props.children}</Styled.h3>
        case "h4":
          return <Styled.h4>{props.children}</Styled.h4>
        case "h5":
          return <Styled.h5>{props.children}</Styled.h5>
        case "h6":
          return <Styled.h6>{props.children}</Styled.h6>
        case "blockquote":
          return <Styled.blockquote>{props.children}</Styled.blockquote>
        default:
          return <Styled.p>{props.children}</Styled.p>
      }
    },
  },
  marks: {
    link: ({ children, mark }) =>
      mark.blank ? (
        <Styled.a href={mark.href} target="_blank" rel="noopener noreferer">
          {children}
        </Styled.a>
      ) : (
        <Styled.a href={mark.href}>{children}</Styled.a>
      ),
  },
}

export default serializers
```

## A SanityContent component

This component isn't technically necessary but I found it helpful to make my final page components a little cleaner and easier to work with without having to repeat code. You pass in a `data` prop from your GraphQL query and then it handles the rest.

```jsx
/** @jsx jsx */
import { jsx } from "theme-ui"
import PortableText from "@sanity/block-content-to-react"
import { useSanityConfig } from "./use-sanity-config"
import serializers from "./serializers"

const SanityContent = ({ data }) => {
  const sanityConfig = useSanityConfig()
  return (
    <PortableText blocks={data} serializers={serializers} {...sanityConfig} />
  )
}

export default SanityContent
```

Your page component might look like this;

```jsx
/** @jsx jsx */
import { jsx } from "theme-ui"
import { useStaticQuery, graphql } from "gatsby"
import SanityContent from "../sanity/sanity-content"

const Page = () => {
  const data = useStaticQuery(graphql`
    query {
      sanityPage {
        title
        seoTitle
        _rawBody
        topimage {
          alt
          asset {
            fluid(maxHeight: 200) {
              ...GatsbySanityImageFluid
            }
          }
        }
      }
    }
  `)

  const result = data.sanityBioPage

  return (
    <Fragment>
      <SEO title={result.seoTitle} />
      <PageHeader
        topImage={result.topimage.asset.fluid}
        topImageAlt={result.topimage.alt}
        title={result.title}
      />
      <SanityContent data={result._rawBody} />
    </Fragment>
  )
}

export default BioQuery
```
